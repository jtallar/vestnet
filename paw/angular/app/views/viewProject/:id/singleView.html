<!--<head>-->
<!--  &lt;!&ndash; build:css(.tmp) styles/detail.css &ndash;&gt;-->
<!--  <link rel="stylesheet" href="styles/detail.css">-->
<!--  &lt;!&ndash; endbuild &ndash;&gt;-->

<!--  &lt;!&ndash; build:css(.tmp) styles/feed.css &ndash;&gt;-->
<!--  <link rel="stylesheet" href="styles/feed.css">-->
<!--  &lt;!&ndash; endbuild &ndash;&gt;-->

<!--</head>-->

<vnheader></vnheader>

<body ng-controller="singleViewCtrl">
<!-- Set used variables -->
<!--
<sec:authorize access="isAuthenticated()">
  <sec:authentication var="session_user_id" property="principal.id"/>
  <sec:authentication var="session_user_mail" property="principal.username"/>
</sec:authorize>

<sec:authorize access="!isAuthenticated()">
  <c:set var="session_user_id" value="0"/>
</sec:authorize>
-->

<!-- Message and Back logic -->
<div class="container sep-nav" style="margin-top: 20px">
    <div class="d-flex justify-content-between align-self-center" style="margin-right:6%">
      <div class="p-2 mx-3 my-1">
        <button ng-click="backAction()" class="btn btn-dark"> {{'back' | translate}} </button>
      </div>
      <div class="p-2 ml-8" id="mail-feedback" ng-if="sent == true">
        <h5 class="card-title mr-4" style="margin-top: 15px; color: #750096"> {{'successfullContact' | translate : {name : project.owner.firstName} }} </h5>
      </div>
    </div>

    <div class="row" style="margin: 0">
      <div class="col-5">
        <div id="carouselExampleCaptions" class="carousel slide" data-ride="carousel" style="width: 100%; margin: 0 auto">
          <ol class="carousel-indicators" id="carousel-slides">
          </ol>

          <div class="carousel-inner">
            <div id="carousel-items">
              <div ng-if="!project.imageExists">
                <img ng-src="images/projectNoImage.png" class="proj-img" alt="{{'projectImage' | translate}}" aria-placeholder="{{'projectImage' | translate}}"/>

              </div>
              <div ng-if="project.imageExists">
                <div class="carrousel-item active">
                  <img ng-src="data:image/JPEG;base64,{{project.image}}" class="proj-img" alt="{{'projectImage' | translate}}" aria-placeholder="{{'projectImage' | translate}}"/>
                </div>
                <div  ng-if="project.slideshowExists">
                  <div class="carousel-item" ng-repeat="image in project.slideshow">
                    <img ng-src="data:image/JPEG;base64,{{image}}"class="proj-img" alt="{{'projectImage' | translate}}" aria-placeholder="{{'projectImage' | translate}}"/>
                  </div>
                </div>

              </div>
            </div>
            </div>
          </div>
          <a class="carousel-control-prev" href="#carouselExampleCaptions" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="false"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="carousel-control-next" href="#carouselExampleCaptions" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="false"></span>
            <span class="sr-only">Next</span>
          </a>
        </div>
      </div>

      <!-- Favorite icon logic -->
      <div class="col-7">
        <div class="d-flex justify-content-center">
          <div class="card description mb-3">
            <!--
            <sec:authorize access="hasRole('ROLE_INVESTOR')">
              <div class="card-header header-white">
                <button onclick="favTap()" class="btn-transp pull-right">
                  <c:choose>
                    <c:when test="${user.favorites.contains(project)}">
                      <c:set var="icon_fav" value="${icon_fav_on}"/>
                    </c:when>
                    <c:otherwise>
                      <c:set var="icon_fav" value="${icon_fav_off}"/>
                    </c:otherwise>
                  </c:choose>
                  <img id="favImg" src="${icon_fav}" height="40">
                </button>
              </div>
            </sec:authorize> -->

            <!-- Project card -->
            <div class="card-body single-card">
              <h5 class="card-title"><b>{{project.name}}</b></h5>
              <div class="blockquote-footer">by {{project.owner.firstName}}
                {{project.owner.lastName}}</div>
              <p class="card-text">{{project.summary}}</p>

              <h5 class="card-title"><b>{{'categories' | translate}}</b></h5>
                <li ng-repeat="category in project.categories">{{category}}</li>
              <br/>

              <h5 class="card-title"><b>{{'contactMail' | translate}}</b></h5>
              <p>{{project.owner.mail}}</p>

              <h5 class="card-title"><b>{{'funding' | translate}}</b></h5>
              <div class="row">
                <div class="col-1"></div>
                <div class="col-5">
                  <h6 class="card-title"><b>{{'target' | translate}}</b> &nbsp; &nbsp;&nbsp; {{'moneyarg' | translate : {m: project.target} }}</h6>
                </div>
                <div class="col-6">
                  <h6 class="card-title"><b>{{'current' | translate}}</b> &nbsp; {{'moneyarg' | translate : {m: project.current} }}</h6>
                </div>
              </div>

              <div class="progress" style="height: 25px; margin: 5px 0 0 8px;">
                <div class="progress-bar progress-bar-striped progress-bar-animated my-bar" role="progressbar" style="font-size: 15px;width: {{project.percentage}}%" aria-valuenow="{{project.percentage}}" aria-valuemin="0" aria-valuemax="100">{{project.percentage}}%</div>
              </div>
              <!--
              <sec:authorize access="isAnonymous()">
                <h5><a href="" class="btn btn-dark btn-sm" data-toggle="modal" data-target="#expFunding">
                  <spring:message code="singleView.button.createToViewProfile"/>
                </a></h5>
              </sec:authorize>
              -->

              <!-- Authorization needed -->
              <!--
              <div class="modal fade" id="expFunding" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog " role="document">
                  <div class="modal-content mx-auto my-auto">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLabel">
                        <spring:message code="aut_needed"/>
                      </h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      <spring:message code="aut_text"/>
                    </div>
                    <div class="modal-footer">
                      <div class="row">

                        <a href="<c:url value="/login"/> " type="button" class="btn btn-dark">
                        <spring:message code="header./login"/>
                        </a>

                        <a href="<c:url value="/signUp"/> " type="button" class="btn btn-dark">
                        <spring:message code="sign_up"/>
                        </a>
                      </div>
                    </div>
                  </div>
                </div>

              </div>
              -->

              <h5  ng-if="userId != project.owner.id"><a href="<c:url value='/users/${project.owner.id}?back=yes'/>"
                         class="btn btn-dark btn-sm">{{'viewProfile' | translate}}</a></h5>
              <div class="dropdown-divider"></div>

              <p class="card-text"><small class="text-muted">{{'lastUpdate' | translate : { date : project.updateDate } }}</small></p>
            </div>
          </div>
        </div>

        <!-- Contact button -->
        <div class="d-flex justify-content-center">
            <a href="/#/chat/1/2" class="btn btn-dark contact-btn" >
              <img src="images/chat-icon.png" class="contact-img">
              {{'contact' | translate}}
            </a>
          <!--
          <sec:authorize access="isAnonymous()">
            <button class="btn btn-dark btn-lg btn-block" aria-controls="contact" id="contact-login-button" data-toggle="modal" data-target="#expFunding">
              <spring:message code="singleView.button.createToContactOwner"/>
            </button>
          </sec:authorize>

          <sec:authorize access="hasRole('ROLE_INVESTOR')">
            <c:choose>
              <c:when test="${lastMessage.isPresent() and lastMessage.get().accepted eq null}">
                <button class="btn btn-dark btn-lg btn-block" id="contact-already-sent-button" disabled>
                  <spring:message code="singleView.button.alreadySent"/>
                </button>
              </c:when>
              <c:otherwise>
                <button class="btn btn-dark btn-lg btn-block" data-toggle="collapse"
                        data-target="#contact" aria-expanded="false" aria-controls="contact" id="contact-expand-button">
                  <spring:message code="contactowner"/>
                </button>
              </c:otherwise>
            </c:choose>
          </sec:authorize>
          -->
        </div>
      </div>
    </div>
    <!--
    <sec:authorize access="hasRole('ROLE_INVESTOR')">
      <div class="collapse" id="contact">
        <div class="card contact">
          <div class="card-header">
            <spring:message code="contact.header" arguments="${project.owner.firstName},${project.owner.lastName}" var="contactHeaderVar"/>
            <label class="label-header"><c:out value="${contactHeaderVar}"/></label>
            <button class="btn btn-dark pull-right" type="button" data-toggle="collapse"
                    data-target="#contact" aria-expanded="false" aria-controls="contact">X
            </button>
          </div>
          <div class="card-body">
            <c:url value="/projects/${project.id}" var="postPath"/>
            <form:form modelAttribute="mailForm" action="${postPath}" method="post">

              <div class="form-group">
                <label><spring:message code="contact.bodyMessage"/></label>
                <div class="input-group mb-3">
                  <spring:message code="writemessage" var="placeholdermessage"/>
                  <form:textarea path="body" type="text" class="form-control"
                                 placeholder="${placeholdermessage}" aria-describedby="basic-addon2"/>
                </div>
                <form:errors path="body" cssClass="formError"/>
              </div>

              <div class="container-contact">
                <div class="row">
                  <div class="col-2">
                    <label><spring:message code="contact.offerMessage"/></label>
                  </div>
                  <div class="col-md-5">
                    <div class="row justify-content-center">
                      <div class="col-2">
                        <label><spring:message code="currency"/></label>
                      </div>
                      <div class="col">
                        <spring:message code="writemessage" var="placeholderoffers"/>
                        <form:input path="offers" type="number" class="form-control"
                                    placeholder="${placeholderoffers}"
                                    aria-describedby="basic-addon2" id="contact-offer"/>
                      </div>
                    </div>
                  </div>
                </div>
                <form:errors path="offers" cssClass="formError"/>
              </div>

              <div class="container-contact">
                <div class="row">
                  <div class="col-2">
                    <label><spring:message code="contact.exchangeMessage"/></label>
                  </div>
                  <div class="col-md-5">
                    <spring:message code="writemessage" var="placeholderexchange"/>
                    <form:textarea path="exchange" type="text" class="form-control"
                                   placeholder="${placeholderexchange}"
                                   aria-describedby="basic-addon2"/>
                  </div>
                </div>
                <form:errors path="exchange" cssClass="formError"/>
              </div>

              <form:input path="receiverId" value="${project.owner.id}" type="hidden"/>

              <div class="text-right">
                <input type="submit" value="<spring:message code="send"/>" class="btn btn-dark"
                onclick="adjustInputs()" id="contact-send"/>
              </div
            </form:form>
          </div>
        </div>
      </div>
    </sec:authorize>
    -->

  <div class="progress my-bar-steps0">
    <div class="progress-bar progress-bar-striped progress-bar-animated
        {{project.stage==1?'bar-red':(project.stage==2?'bar-orange':(project.stage==3?'bar-yellow':(project.stage==4?'bar-cyan':'bar-green')))}}"
         role="progressbar" style="width: {{project.stage*20}}%" aria-valuenow="{{project.stage}}" aria-valuemin="0" aria-valuemax="5"></div>
  </div>

  <div ng-if="owner===false" class="card-group history-group">
    <div class="{{project.stage > 0 ? 'card bg-danger h-step' : 'card border-danger h-step'}}">
      <div class="card-body h-step-b">
        <h5 class="card-title">{{project.stages[0].name}}</h5>
        <p class="card-text">{{project.stages[0].comment}}</p>
      </div>
    </div>
    <div class="{{project.stage > 1 ? 'card bg-orange h-step' : 'card border-orange h-step'}}">
      <div class="card-body h-step-b">
        <h5 class="card-title">{{project.stages[1].name}}</h5>
        <p class="card-text">{{project.stages[1].comment}}</p>
      </div>
    </div>
    <div class="{{project.stage > 2 ? 'card bg-warning h-step' : 'card border-warning h-step'}}">
      <div class="card-body h-step-b">
        <h5 class="card-title">{{project.stages[2].name}}</h5>
        <p class="card-text">{{project.stages[2].comment}}</p>
      </div>
    </div>
    <div class="{{project.stage > 3 ? 'card bg-cyan h-step' : 'card border-cyan h-step'}}">
      <div class="card-body h-step-b">
        <h5 class="card-title">{{project.stages[3].name}}</h5>
        <p class="card-text">{{project.stages[3].comment}}</p>
      </div>
    </div>
    <div class="{{project.stage > 4 ? 'card bg-success h-step' : 'card border-success h-step'}}">
      <div class="card-body h-step-b">
        <h5 class="card-title">{{project.stages[4].name}}</h5>
        <p class="card-text">{{project.stages[4].comment}}</p>
      </div>
    </div>
  </div>

  <div ng-if="owner===true" class="card-group history-group">
    <div class="{{project.stage > 0 ? 'card bg-danger h-step' : 'card border-danger h-step'}}">
      <div class="card-body stage-body h-step-b">
        <h5 ng-if="project.stage>=1" class="card-title">{{project.stages[0].name}}</h5>
        <p ng-if="project.stage>=1" class="card-text">{{project.stages[0].comment}}</p>
        <input ng-if="project.stage==0" ng-model="new.name" maxlength="14" type="text" class="form-control stage-name" placeholder="{{'stage' | translate}}" id="s1i"/>
        <textarea ng-if="project.stage==0" ng-model="new.comment" maxlength="140" class="border-danger form-control" placeholder="{{'comments' | translate}}" rows="5" id="s1"></textarea>
        <button ng-if="project.stage==0" class="btn btn-inv text-center" ng-click="addStage(new.name, new.comment)" style="margin-left:40%; margin-top:10px">
          <img src="images/add-icon.png" alt="" class="img-invest">
        </button>
        <button ng-if="project.stage==1" class="btn btn-inv text-center" ng-click="deleteStage(1)" style="margin-left:40%; margin-top:10px">
          <img src="images/delete-icon.png" alt="" class="img-invest">
        </button>
      </div>
    </div>
    <div class="{{project.stage > 1 ? 'card bg-orange h-step' : 'card border-orange h-step'}}">
      <div class="card-body stage-body h-step-b">
        <h5 ng-if="project.stage>=2" class="card-title">{{project.stages[1].name}}</h5>
        <p ng-if="project.stage>=2" class="card-text">{{project.stages[1].comment}}</p>
        <input ng-if="project.stage==1" ng-model="new.name" maxlength="14" type="text" class="form-control stage-name" placeholder="{{'stage' | translate}}" id="s2i"/>
        <textarea ng-if="project.stage==1" ng-model="new.comment" maxlength="140" class="border-orange form-control" placeholder="{{'comments' | translate}}" rows="5" id="s2"></textarea>
        <button ng-if="project.stage==1" class="btn btn-inv text-center" ng-click="addStage(new.name, new.comment)" style="margin-left:40%; margin-top:10px">
          <img src="images/add-icon.png" alt="" class="img-invest">
        </button>
        <button ng-if="project.stage==2" class="btn btn-inv text-center" ng-click="deleteStage(2)" style="margin-left:40%; margin-top:10px">
          <img src="images/delete-icon.png" alt="" class="img-invest">
        </button>
      </div>
    </div>
    <div class="{{project.stage > 2 ? 'card bg-warning h-step' : 'card border-warning h-step'}}">
      <div class="card-body stage-body h-step-b">
        <h5 ng-if="project.stage>=3" class="card-title">{{project.stages[2].name}}</h5>
        <p ng-if="project.stage>=3" class="card-text">{{project.stages[2].comment}}</p>
        <input ng-if="project.stage==2" ng-model="new.name" maxlength="14" type="text" class="form-control stage-name" placeholder="{{'stage' | translate}}" id="s3i"/>
        <textarea ng-if="project.stage==2" ng-model="new.comment" maxlength="140" class="border-warning form-control" placeholder="{{'comments' | translate}}" rows="5" id="s3"></textarea>
        <button ng-if="project.stage==2" class="btn btn-inv text-center" ng-click="addStage(new.name, new.comment)" style="margin-left:40%; margin-top:10px">
          <img src="images/add-icon.png" alt="" class="img-invest">
        </button>
        <button ng-if="project.stage==3" class="btn btn-inv text-center" ng-click="deleteStage(3)" style="margin-left:40%; margin-top:10px">
          <img src="images/delete-icon.png" alt="" class="img-invest">
        </button>
      </div>
    </div>
    <div class="{{project.stage > 3 ? 'card bg-cyan h-step' : 'card border-cyan h-step'}}">
      <div class="card-body stage-body h-step-b">
        <h5 ng-if="project.stage>=4" class="card-title">{{project.stages[3].name}}</h5>
        <p ng-if="project.stage>=4" class="card-text">{{project.stages[3].comment}}</p>
        <input ng-if="project.stage==3" ng-model="new.name" maxlength="14" type="text" class="form-control stage-name" placeholder="{{'stage' | translate}}" id="s4i"/>
        <textarea ng-if="project.stage==3" ng-model="new.comment" maxlength="140" class="border-cyan form-control" placeholder="{{'comments' | translate}}" rows="5" id="s4"></textarea>
        <button ng-if="project.stage==3" class="btn btn-inv text-center" ng-click="addStage(new.name, new.comment)" style="margin-left:40%; margin-top:10px">
          <img src="images/add-icon.png" alt="" class="img-invest">
        </button>
        <button ng-if="project.stage==4" class="btn btn-inv text-center" ng-click="deleteStage(4)" style="margin-left:40%; margin-top:10px">
          <img src="images/delete-icon.png" alt="" class="img-invest">
        </button>
      </div>
    </div>
    <div class="{{project.stage > 4 ? 'card bg-success h-step' : 'card border-success h-step'}}">
      <div class="card-body stage-body h-step-b">
        <h5 ng-if="project.stage>=5" class="card-title">{{project.stages[4].name}}</h5>
        <p ng-if="project.stage>=5" class="card-text">{{project.stages[4].comment}}</p>
        <input ng-if="project.stage==4" ng-model="new.name" maxlength="14" type="text" class="form-control stage-name" placeholder="{{'stage' | translate}}" id="s5i"/>
        <textarea ng-if="project.stage==4" ng-model="new.comment" maxlength="140" class="border-success form-control" placeholder="{{'comments' | translate}}" rows="5" id="s5"></textarea>
        <button ng-if="project.stage==4" class="btn btn-inv text-center" ng-click="addStage(new.name, new.comment)" style="margin-left:40%; margin-top:10px">
          <img src="images/add-icon.png" alt="" class="img-invest">
        </button>
        <button ng-if="project.stage==5" class="btn btn-inv text-center" ng-click="deleteStage(5)" style="margin-left:40%; margin-top:10px">
          <img src="images/delete-icon.png" alt="" class="img-invest">
        </button>
      </div>
    </div>
  </div>

</div>
<!--</div>-->

</body>


<footer>
  <vnfooter></vnfooter>
</footer>


